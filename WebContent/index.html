<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Thing Description Playground - Validate your W3C Thing Description</title>
	<link rel="shortcut icon" type="image/x-icon" href="favlogo.png" />
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="css/playground.css" />
	<script type="text/javascript" src="js/node_modules/jsonld/dist/jsonld.js"></script>
	<script type="text/javascript" src="js/ajv.min.js"></script>
	<script type="text/javascript" src="js/UTILS/helperFunctions.js"></script>
	<script type="text/javascript" src="js/jquery-2.2.3.js"></script>
	<script type="text/javascript" src="js/jquery-linedtextarea.js"></script>
	<script type="text/javascript" src="js/playground.js"></script>
	<script type="text/javascript" src="js/td-schema-full-var.json"></script>	<script type="text/javascript" src="js/td-schema-full-var.json"></script>
	<script src="js/monaco/min/vs/loader.js"></script>

	
	
</head>


<body>
 
		
		<div class="container" style="padding-top:0px">

				<div class="row alert alert-info" style="padding:0px">
						<div class="col-3">
							  <div>
									  <img alt="Thingweb logo" src="logo.png"  style="float: left; height:40px;">
									  </div>
						</div>
						<div class="col-9">
							  <h3 style="display: inline;">Thing Description Playground</h3><br>
							  
								   <a href="https://w3c.github.io/wot-thing-description/#" target="_blank">Validation according to</a>
						  
						</div>
						
					  </div>
			<div class="row">
				<div class="col-9"> 
					<div id="monaco" style="min-height: 200px;max-height: 100%;height: 100%; width: auto;">
					</div>
				</div>
				

				<div class="col">
						<font size="3" face="Arial" >
						<div class="panel">		
							<table class="table">
								<tr  id="validation_table_head" class="btn-info">
									<th  rowspan="2"> &nbsp<i id="table_head_arrow" class="down"></i>&nbsp</th>
									<tbody id="validation_table">
										<td >
											<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
												<circle id="spot-json" cx="10" cy="10" r="9" />
											</svg>
										</td>
										<td title="Is green when TD is a valid JSON">JSON validation</td>
									</tr>
									<tr>
										<td >
											<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
												<circle id="spot-simple-json-schema" cx="10" cy="10" r="9" />
											</svg>
										</td>
										<td title="Is green when TD is valid according to the JSON Schema of the TD spec">JSON
											Schema validation</td>
									</tr>
									<tr>
										<td>
											<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
												<circle id="spot-full-json-schema" cx="10" cy="10" r="9" />
											</svg>
										</td>
										<td
											title="Is green when the validated TD has no default assumptions and everything is explicitly declared">
											(With Defaults) JSON Schema validation</td>
									</tr>
									<tr>
									<tr>
										<td>
											<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
												<circle id="spot-json-ld" cx="10" cy="10" r="9" />
											</svg>
										</td>
										<td title="Is green when TD can be expanded using the @context value">JSON-LD validation
										</td>
									</tr>
									<tr>
										<td>
											<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
												<circle id="spot-add" cx="10" cy="10" r="9" />
											</svg>
										</td>
										<td title="Is green when all custom checks pass">Additional Checks</td>
									</tr>
								</tbody>
							</table>
								
		
							<form >
								<div class="form-group">
									<input   style="margin-bottom: 0px; margin-top: 0px" type="checkbox"  id="box_auto_validate" value="off"> Auto Validate <br>
									<button  style="margin-bottom: 0px; margin-top: 0px" type="button" class="btn" id="btn_validate">Validate</button>
									<button  style="margin-bottom: 0px; margin-top: 0px" type="button" class="btn" id="btn_clearLog" >Clear Log</button>
									
									<button type="button" class="btn" id="btn_gistify">Gistify</button>
									<button type="button" class="btn" id="btn_assertion">Assertion Test</button>
								</div>
								
								
		
							</form>
		
							
							
							<div>
							<table class="table" >
		
								<tbody>
									<tr>
										<td>Examples: </td>
										
										<td>
										<select  id="load_example" class="btn btn-info dropdown-toggle" >							
												<option class="btn-info" style="margin:0px" value="select_none">Select None </option>
												
													
											 </select>
										</td>
										
									</tr>
								</tbody>
							</table>
						</div>
							<div style="margin: 0px; border: solid 3px #188b3b; padding: 0px">
							<a  class="btn" href="https://github.com/thingweb/thingweb-playground/issues/new" target="_blank"> Create Issue </a>
					
							<a class="btn" href="https://github.com/thingweb/thingweb-playground/tree/master/Scripts" target="_blank"> Script Validation </a>
					
							<a class="btn" href="https://github.com/thingweb/thingweb-playground/tree/master/AssertionTester" target="_blank"> Assertion Tester </a>
								</div>
						
						
						</div>
					</font>
					
					</div>
			</div>
			
		

			

			<div class="row" style="max-height:250px;overflow-y:scroll;">
				<div class="col">
						<pre id="console" >Waiting for validation...&#13;&#10;</pre>
				</div>
				
			</div>
			<div id="offline-warning"></div>
	</div>



	 


	<footer class="foot">
			<div class="footer-shape">
					<img src="footer-shape.jpg" width="100%" height="50">
				</div>
		<div class="links">
			<ul>
				<li>
					<a href="http://www.eclipse.org/">Eclipse Foundation</a>
				</li>
				<li>|</li>
				<li>
					<a href="http://www.eclipse.org/legal/privacy.php">Privacy policy</a>
				</li>
				<li>|</li>
				<li>
					<a href="http://www.eclipse.org/legal/termsofuse.php">Terms of use</a>
				</li>
				<li>|</li>
				<li>
					<a href="http://www.eclipse.org/legal/copyright.php">Copyright</a>
				</li>
				<li>|</li>
				<li>
					<a href="http://www.eclipse.org/legal">Legal</a>
				</li>
			</ul>
			<p>Copyrights Â© 2019 Eclipse Thingweb. All Rights Reserved.<p>
		</div>
		
			
		
	</footer>
	
</body>

</html>

<script>



$(document).ready(function(){

	if(browserName()!="Firefox")// Shows warning if the Browser is other than Firefox
		{
			$( "#offline-warning" ).append("<b> Warning:</b> Browsers other than Firefox present will not work for offline validation due to CORS policy.<br>");
		}

  // when table is extracted
	$("#validation_table").fadeOut("fast",function(){
		$("#table_head_arrow").removeClass();
        $("#table_head_arrow").toggleClass("down");
	}); 

	$("#validation_table_head").click(toggleValidationStatusTable);// Toggles Validation Table view
	$("#box_auto_validate").change(function(){ // Auto validates only when the box is checked.
		autoValidate=$("#box_auto_validate").prop("checked");

	});
	


	

	let urlAddrObject= getExamplesList();//Fetching list of examples from the given array(in helperFunctions.js). 
	populateExamples(urlAddrObject);     // Loaing the examples given in list from their respective URLs

	$("#load_example").change({urlAddrObject:urlAddrObject},exampleSelectHandler);// attaching handler to the drop down menu of the exmaples list.
  
	$("#btn_assertion").click(performAssertionTest);// attaching function to the assertion button, the function performs Assertion test

	$("#btn_validate").click({source:"manual"},validate);// attaching Function to the Validate(Manual) Button.

	$("#btn_gistify").click(submitAsGist);// Attaching Function to Gistify Button, The functions handles submitting TD as Gist.

	$("#btn_clearLog").click(clearLog); // Clear logs
		
	$("#td-text").keydown(textAreaManipulation);// Text area manipulation
   
//**************************Monaco editor code*********************************////		
    require.config({ paths: { 'vs': 'js/monaco/min/vs' }});
    require(['vs/editor/editor.main'], editor=function() {
       

		var jsonCode = [                       //Temporary initial Json
    					'{',
   					 '    "p1": "v3",',
   					 '    "p2": false',
  							  "}"
						].join('\n');
		var modelUri = monaco.Uri.parse("a://b/foo.json"); // a made up unique URI for our model
		var model = monaco.editor.createModel(jsonCode, "json", modelUri);



	// configure the JSON language support with schemas and schema associations
	monaco.languages.json.jsonDefaults.setDiagnosticsOptions({
		validate: true,
		//schemas: [schema] // List of schemas to validate against, It will validate the TD with in the editor area.
		schemas:[{
			uri: "http://myserver/foo-schema.json", // id of the first schema
			fileMatch: [modelUri.toString()], // associate with our model
			// schema: {
			//     type: "object",
			//     properties: {
			//         p1: {
			//             enum: ["v1", "v2"]
			//         },
			//         p2: {
			//             $ref: "http://myserver/bar-schema.json" // reference the second schema
			//         }
			//     }
			schema:{
				$ref: "https://raw.githubusercontent.com/thingweb/thingweb-playground/master/WebContent/td-schema.json"
			}   
		}
		]

				});

	window.editor=monaco.editor.create(document.getElementById("monaco"), {
    	model: model,
	

});

	model.onDidChangeContent((event) => { // When text in the Editor changes
		validate(event,"auto");
	});


        });
  
//*************************************************************************////


	
});







	</script>