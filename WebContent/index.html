<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Thing Description Playground - Validate your W3C Thing Description</title>
	<!-- <link rel="stylesheet" type="text/css" href="css/pure-0.6.0.css" /> -->
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="css/pure-min.css" />
	<link rel="stylesheet" type="text/css" href="css/grids-responsive-min.css" />
	
    
	<!-- <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css"> -->
	<link rel="stylesheet" type="text/css" href="css/jquery-linedtextarea.css" />
	<link rel="stylesheet" type="text/css" href="css/playground.css" />
	

	<script type="text/javascript" src="js/node_modules/jsonld/dist/jsonld.js"></script>
	<script type="text/javascript" src="js/ajv.min.js"></script>
	<script type="text/javascript" src="js/UTILS/helperFunctions.js"></script>
	<script type="text/javascript" src="js/jquery-2.2.3.js"></script>
	<script type="text/javascript" src="js/jquery-linedtextarea.js"></script>
	<script type="text/javascript" src="js/playground.js"></script>
	

	
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
		integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
	<!--[if lte IE 8]>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/grids-responsive-old-ie-min.css">
<![endif]-->
	<!--[if gt IE 8]><!-->
	<!-- <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/grids-responsive-min.css"> -->
	<!--<![endif]-->
</head>
<header>
		<div class="container-fluid">
				<div class="row alert alert-info">
				  <div class="col-sm">
						<div>
								<img alt="Thingweb logo" src="logo.png"  style="float: left; height:50px; widows: 100px;">
								</div>
				  </div>
				  <div class="col-sm">
						<h1 class="pure-u-1 header" style="display: inline;">Thing Description Playground</h1>
				  </div>
				  <div class="col-sm">
					
				<div     >
						<a class="btn btn-success" href="https://github.com/thingweb/thingweb-playground/issues/new" target="_blank"> Create Issue </a>
			
						<a class="btn btn-success" href="https://github.com/thingweb/thingweb-playground/tree/master/Scripts" target="_blank"> Script Validation </a>
			
						<a class="btn btn-success" href="https://github.com/thingweb/thingweb-playground/tree/master/AssertionTester" target="_blank"> Assertion Tester </a>

					</div>
				  </div>
				</div>
			  </div>
	
</header>

<body>

		
	
		<div id="offline-warning">
			</div>
			<div class="pure-g wrap">

			<div class="pure-u-17-24">
					
				<textarea  autofocus id="td-text" name="td-text" rows="32"
					placeholder="Enter Thing Description here...">
					
				</textarea>
				
			</div>

			<div class="pure-u-6-24">
				<div class="panel">

					<table class="pure-table pure-table-bordered" >
						
							<tr  id="validation_table_head" class="btn-info">
									<th  rowspan="2"> <i id="table_head_arrow" class="down"></i></th>
									
						<tbody id="validation_table">
							
							</tr>
							<tr>
								<td>
									<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
										<circle id="spot-json" cx="10" cy="10" r="9" />
									</svg>
								</td>
								<td title="Is green when TD is a valid JSON">JSON validation</td>
							</tr>
							<tr>
								<td>
									<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
										<circle id="spot-simple-json-schema" cx="10" cy="10" r="9" />
									</svg>
								</td>
								<td title="Is green when TD is valid according to the JSON Schema of the TD spec">JSON
									Schema validation</td>
							</tr>
							<tr>
								<td>
									<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
										<circle id="spot-full-json-schema" cx="10" cy="10" r="9" />
									</svg>
								</td>
								<td
									title="Is green when the validated TD has no default assumptions and everything is explicitly declared">
									(With Defaults) JSON Schema validation</td>
							</tr>
							<tr>
							<tr>
								<td>
									<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
										<circle id="spot-json-ld" cx="10" cy="10" r="9" />
									</svg>
								</td>
								<td title="Is green when TD can be expanded using the @context value">JSON-LD validation
								</td>
							</tr>
							<tr>
								<td>
									<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg">
										<circle id="spot-add" cx="10" cy="10" r="9" />
									</svg>
								</td>
								<td title="Is green when all custom checks pass">Additional Checks</td>
							</tr>
						</tbody>
					</table>

					<form class="pure-form">
						<input type="checkbox"  id="box_auto_validate" value="off"> Auto Validate <br>
						<button type="button" class="pure-button" id="btn_validate">Validate</button>
						<button type="button" class="pure-button" onclick="javascript:clearLog()">Clear Log</button>
						
						<button type="button" class="pure-button" id="btn_gistify">Gistify</button>
						
						
						


					</form>

					
					<pre></pre>
					<table class="pure-table" >

						<tbody>
							<tr>
								<td>Examples: </td>
								
								<td>
								<select  id="load_example" class="btn btn-info dropdown-toggle" >							
										<option class="btn-info" value="select_none">Select None </option>
										
											
									 </select>
								</td>
								
							</tr>
						</tbody>
					</table>
				</div>
			</div>

			<div class="pure-u-1 header">
				<pre></pre>
			</div>

			<div class="pure-u-1" style=" 
			max-height:250px;
			overflow-y:scroll;">
				<pre id="console">Waiting for validation...&#13;&#10;</pre>
			</div>
	</div>


	<div class="footer-shape">
		<img src="footer-shape.jpg" width="100%">
	</div>
	 


	<footer>
		<div class="links">
			<ul>
				<li>
					<a href="http://www.eclipse.org/">Eclipse Foundation</a>
				</li>
				<li>|</li>
				<li>
					<a href="http://www.eclipse.org/legal/privacy.php">Privacy policy</a>
				</li>
				<li>|</li>
				<li>
					<a href="http://www.eclipse.org/legal/termsofuse.php">Terms of use</a>
				</li>
				<li>|</li>
				<li>
					<a href="http://www.eclipse.org/legal/copyright.php">Copyright</a>
				</li>
				<li>|</li>
				<li>
					<a href="http://www.eclipse.org/legal">Legal</a>
				</li>
			</ul>
		</div>
		<div>
			<p>Copyrights Â© 2019 Eclipse Thingweb. All Rights Reserved.</p>
		</div>
	</footer>
	
</body>

</html>

<script>



$(document).ready(function(){



	$("#td-text").keydown(function(e) {
    if(e.keyCode === 9) { // tab was pressed
        // get caret position/selection
        var start = this.selectionStart;
        var end = this.selectionEnd;

        var $this = $(this);
        var value = $this.val();

        // set textarea value to: text before caret + tab + text after caret
        $this.val(value.substring(0, start)
                    + "\t"
                    + value.substring(end));

        // put caret at right position again (add one for the tab)
        this.selectionStart = this.selectionEnd = start + 1;

        // prevent the focus lose
        e.preventDefault();
    }
});


	
	let urlAddrObject= getExamplesList();
	populateExamples(urlAddrObject);
	$("#load_example").change({urlAddrObject:urlAddrObject},exampleSelectHandler);
	$("#validation_table").fadeOut("fast",function(){
		$("#table_head_arrow").removeClass();
        $("#table_head_arrow").toggleClass("down");
	}); 

	$("#validation_table_head").click(function(e){
				$("#validation_table").fadeToggle("fast"); 
				if($("#table_head_arrow").attr('class')=="up"){
					$("#table_head_arrow").removeClass();
       				 $("#table_head_arrow").toggleClass("down");

				}
				else{
					{
					$("#table_head_arrow").removeClass();
       				 $("#table_head_arrow").toggleClass("up");

				}

				}

		
				});
	

	
	$("#td-text").keyup({source:"auto"},validate);
	
	$("#btn_validate").click({source:"manual"},validate);
	
	$("#box_auto_validate").change(function(){ 
		autoValidate=$("#box_auto_validate").prop("checked");

	});

	


	
	if(browserName()!="Firefox")
	{
	$( "#offline-warning" ).append("<b> Warning:</b> Browsers other than Firefox present will not work for offline validation due to CORS policy.<br>");
	}
   

	$("#btn_gistify").click(submitAsGist);


	function submitAsGist(){
		var name = prompt("Please enter the Name of TD:");
		
		var data={
				"description": "Directly from playground",
					"public": true,
					"files": {
					[name]: {
					"content": $('#td-text').val()
							}
					}
				};

			var url='https://api.github.com/gists';

			/////please fill in the token after getting the code from github for example:
			////"Authorization" : `Token #`
			////To
			////"Authorization" : `Token 60222272d2d5c5a82d2df4a857c528cf4620f175`

			const headers = {
					"Authorization" : `Token #`
				}
			
			$.ajax({
					type: "POST",
					url: url,
					headers:headers,
					success: success,
					data:JSON.stringify(data),
					error: function(XMLHttpRequest, textStatus, errorThrown) {
     					alert(errorThrown);
 					 }

			
				});

				function success(data)
					{
						alert("TD has been submitted."+'<br> <a id="gistify_link_visibility" href='+data.url +'target="_blank">Your Gist</a>');
						window.open(data.url, '_blank');
						

						}
				}
   
		
			

	
});




	</script>